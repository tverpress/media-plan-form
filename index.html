<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <!-- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="–§–æ—Ä–º–∞ –¥–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –º–µ–¥–∏–∞–ø–ª–∞–Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π">
  <meta name="keywords" content="–º–µ–¥–∏–∞–ø–ª–∞–Ω, —Ñ–æ—Ä–º–∞, –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –ø—Ä–∞–≤–æ—Å–ª–∞–≤–∏–µ">
  <title>–§–æ—Ä–º–∞ –¥–ª—è –º–µ–¥–∏–∞–ø–ª–∞–Ω–∞</title>
  
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìù</text></svg>">

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Bootstrap 5 (—á–µ—Ä–µ–∑ CDN) -->
  <link 
    rel="stylesheet" 
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
  >
  
  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–∞—à–∏ —Å—Ç–∏–ª–∏ -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- –û–≤–µ—Ä–ª–µ–π –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ -->
<div id="successOverlay" class="overlay">
  <div class="overlay-content">
    <h2>–§–æ—Ä–º–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!</h2>
    <p>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –•–æ—Ç–∏—Ç–µ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –µ—â—ë?</p>
    <button type="button" class="btn" id="fillAgainBtn">–ó–∞–ø–æ–ª–Ω–∏—Ç—å –µ—â—ë</button>
  </div>
</div>

<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ñ–æ—Ä–º—ã -->
<div class="container form-container">
  <h1 class="my-4">–§–æ—Ä–º–∞ –¥–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –º–µ–¥–∏–∞–ø–ª–∞–Ω–∞</h1>

  <form id="eventForm">
    <!-- –î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç -->
    <div class="mb-3">
      <label for="department" class="form-label">–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç</label>
      <select 
        class="form-select" 
        id="department" 
        name="department" 
        required
      >
        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç --</option>
        <option value="–í–æ—Å–∫—Ä–µ—Å–Ω–∞—è —à–∫–æ–ª–∞">–í–æ—Å–∫—Ä–µ—Å–Ω–∞—è —à–∫–æ–ª–∞</option>
        <option value="–ö—É—Ä—Å—ã –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–∞–≤–æ—Å–ª–∞–≤–∏—è">–ö—É—Ä—Å—ã –ø–æ –æ—Å–Ω–æ–≤–∞–º –ø—Ä–∞–≤–æ—Å–ª–∞–≤–∏—è</option>
        <option value="–ú–æ–ª–æ–¥–µ–∂–Ω—ã–π –∫–ª—É–±">–ú–æ–ª–æ–¥–µ–∂–Ω—ã–π –∫–ª—É–±</option>
        <option value="–æ—Ç—Ä—è–¥ —Å–∫–∞—É—Ç–æ–≤">–æ—Ç—Ä—è–¥ —Å–∫–∞—É—Ç–æ–≤</option>
        <option value="—Ç–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä—É–∂–æ–∫">—Ç–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä—É–∂–æ–∫</option>
        <option value="–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ —Ü–µ—Ä–∫–æ–≤–Ω—É—é –ª–∞–≤–∫—É">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ —Ü–µ—Ä–∫–æ–≤–Ω—É—é –ª–∞–≤–∫—É</option>
        <option value="–•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å">–•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å</option>
        <option value="–ü–∏—Ç–∞–Ω–∏–µ">–ü–∏—Ç–∞–Ω–∏–µ</option>
        <option value="–ü–æ–Ω–æ–º–∞—Ä—Å–∫–æ–µ —Å–ª—É–∂–µ–Ω–∏–µ">–ü–æ–Ω–æ–º–∞—Ä—Å–∫–æ–µ —Å–ª—É–∂–µ–Ω–∏–µ</option>
        <option value="–ê—Ä—Ö–∏–µ—Ä–µ–π—Å–∫–∏–π —Ö–æ—Ä">–ê—Ä—Ö–∏–µ—Ä–µ–π—Å–∫–∏–π —Ö–æ—Ä</option>
        <option value="–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ">–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</option>
      </select>
    </div>

    <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è -->
    <div class="mb-3">
      <label for="eventName" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</label>
      <input 
        type="text" 
        class="form-control" 
        id="eventName" 
        name="eventName" 
        required
      >
    </div>

    <!-- –î–µ–Ω—å –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è -->
    <div class="mb-3">
      <label for="eventDay" class="form-label">–î–µ–Ω—å –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</label>
      <input 
        type="date" 
        class="form-control" 
        id="eventDay" 
        name="eventDay" 
        required
      >
    </div>

    <!-- –í—Ä–µ–º—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è -->
    <div class="mb-3">
      <label for="eventTime" class="form-label">–í—Ä–µ–º—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è</label>
      <input 
        type="time" 
        class="form-control" 
        id="eventTime" 
        name="eventTime" 
        required
      >
    </div>

    <!-- –ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è -->
    <div class="mb-3">
      <label for="eventPlace" class="form-label">–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</label>
      <input 
        type="text" 
        class="form-control" 
        id="eventPlace" 
        name="eventPlace" 
        required
      >
    </div>

    <!-- –ù—É–∂–µ–Ω –ª–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ? (radio group) -->
    <div class="mb-3">
      <label class="form-label d-block">–ù—É–∂–µ–Ω –ª–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ?</label>
      <div class="form-check">
        <input 
          class="form-check-input" 
          type="radio" 
          name="photographer" 
          id="photographer_yes" 
          value="–î–∞" 
          required
        >
        <label class="form-check-label" for="photographer_yes">–î–∞</label>
      </div>
      <div class="form-check">
        <input 
          class="form-check-input" 
          type="radio" 
          name="photographer" 
          id="photographer_own" 
          value="–ù–µ—Ç. –ú—ã —Å–∞–º–∏ —Å–¥–µ–ª–∞–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –ø—Ä–∏—à–ª–µ–º –∏—Ö –≤–∞–º"
        >
        <label class="form-check-label" for="photographer_own">
          –ù–µ—Ç. –ú—ã —Å–∞–º–∏ —Å–¥–µ–ª–∞–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –ø—Ä–∏—à–ª–µ–º –∏—Ö –≤–∞–º
        </label>
      </div>
      <div class="form-check">
        <input 
          class="form-check-input" 
          type="radio" 
          name="photographer" 
          id="photographer_no" 
          value="–ù–µ—Ç. –ù–∞ —ç—Ç–æ–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–∏ –Ω–µ –Ω–∞–¥–æ –¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏"
        >
        <label class="form-check-label" for="photographer_no">
          –ù–µ—Ç. –ù–∞ —ç—Ç–æ–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–∏ –Ω–µ –Ω–∞–¥–æ –¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
        </label>
      </div>
    </div>

    <!-- –ù—É–∂–µ–Ω –ª–∏ –∫–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç? (radio group) -->
    <div class="mb-3">
      <label class="form-label d-block">–ù—É–∂–µ–Ω –ª–∏ –∫–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç?</label>
      <div class="form-check">
        <input 
          class="form-check-input" 
          type="radio" 
          name="correspondent" 
          id="correspondent_yes" 
          value="–î–∞" 
          required
        >
        <label class="form-check-label" for="correspondent_yes">
          –î–∞
        </label>
      </div>
      <div class="form-check">
        <input 
          class="form-check-input" 
          type="radio" 
          name="correspondent" 
          id="correspondent_no" 
          value="–ù–µ—Ç, –º—ã —Å–∞–º–∏ –Ω–∞–ø–∏—à–µ–º –æ–± —ç—Ç–æ–º –∏ –ø—Ä–∏—à–ª–µ–º –≤–∞–º"
        >
        <label class="form-check-label" for="correspondent_no">
          –ù–µ—Ç, –º—ã —Å–∞–º–∏ –Ω–∞–ø–∏—à–µ–º –æ–± —ç—Ç–æ–º –∏ –ø—Ä–∏—à–ª–µ–º –≤–∞–º
        </label>
      </div>
    </div>

    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="mb-3">
      <label for="additionalInfo" class="form-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</label>
      <textarea 
        class="form-control" 
        id="additionalInfo" 
        name="additionalInfo" 
        rows="3"
      ></textarea>
    </div>

    <!-- –ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ (–§–ò–û) -->
    <div class="mb-3">
      <label for="contactName" class="form-label">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ (–§–ò–û)</label>
      <input 
        type="text" 
        class="form-control" 
        id="contactName" 
        name="contactName" 
        required
      >
    </div>

    <!-- –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è —Å–≤—è–∑–∏ -->
    <div class="mb-3">
      <label for="contactPhone" class="form-label">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è —Å–≤—è–∑–∏</label>
      <input 
        type="tel" 
        class="form-control" 
        id="contactPhone" 
        name="contactPhone" 
        pattern="^(\+7|8)?[\s\-]?\(?\d{3}\)?[\s\-]?\d{3}[\s\-]?\d{2}[\s\-]?\d{2}$"
        placeholder="+7 (XXX) XXX-XX-XX"
        required
      >
      <div class="form-text">–§–æ—Ä–º–∞—Ç: +7 (XXX) XXX-XX-XX –∏–ª–∏ 8XXXXXXXXXX</div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
    <button type="submit" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </form>

  <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
  <div class="mt-3" id="statusMessage"></div>
</div>

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Bootstrap JS (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞) -->
<script 
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js">
</script>

<script>
  // –í–ê–®–ê —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Google Apps Script
  const scriptURL = 'https://script.google.com/macros/s/AKfycbzOjcghIjYf6Be6bMJzxXlw1loE7Z6vKBD54au000CVJkMf3paPPak6xIY9RFHxOONGww/exec';

  // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
  const form = document.getElementById('eventForm');
  const statusMessage = document.getElementById('statusMessage');
  const successOverlay = document.getElementById('successOverlay');
  const fillAgainBtn = document.getElementById('fillAgainBtn');

  // ======== –†–∞–±–æ—Ç–∞ —Å –∫—É–∫–∏ (department, contactName, contactPhone) ========
  function setCookie(name, value, days) {
    try {
      const d = new Date();
      d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
      const expires = "expires=" + d.toUTCString();
      document.cookie = name + "=" + encodeURIComponent(value || "") + ";" + expires + ";path=/";
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫—É–∫–∏:', error);
    }
  }

  function getCookie(name) {
    try {
      const nameEQ = name + "=";
      const ca = document.cookie.split(';');
      for (let i = 0; i < ca.length; i++) {
        let c = ca[i].trim();
        if (c.indexOf(nameEQ) === 0) {
          return decodeURIComponent(c.substring(nameEQ.length, c.length));
        }
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫—É–∫–∏:', error);
    }
    return null;
  }

  // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã - –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—É–∫–∏
  window.addEventListener('DOMContentLoaded', () => {
    const savedDepartment = getCookie('department');
    if (savedDepartment) {
      document.getElementById('department').value = savedDepartment;
    }
    const savedContactName = getCookie('contactName');
    if (savedContactName) {
      document.getElementById('contactName').value = savedContactName;
    }
    const savedContactPhone = getCookie('contactPhone');
    if (savedContactPhone) {
      document.getElementById('contactPhone').value = savedContactPhone;
    }
  });

  // –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã
  form.addEventListener('submit', e => {
    e.preventDefault();
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
    if (!form.checkValidity()) {
      e.stopPropagation();
      form.classList.add('was-validated');
      statusMessage.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è';
      statusMessage.className = 'mt-3 text-danger';
      return;
    }
    
    statusMessage.textContent = '–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ...';
    statusMessage.className = 'mt-3 text-info';

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫—É–∫–∏
    const departmentValue  = document.getElementById('department').value;
    const contactNameValue = document.getElementById('contactName').value;
    const contactPhoneValue = document.getElementById('contactPhone').value;
    setCookie('department', departmentValue, 365);
    setCookie('contactName', contactNameValue, 365);
    setCookie('contactPhone', contactPhoneValue, 365);

    // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
    const formData = new FormData(form);

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ Apps Script
    fetch(scriptURL, { method: 'POST', body: formData })
      .then(response => {
        if (!response.ok) throw new Error('Network response was not ok');
        return response.text();
      })
      .then(result => {
        // –£–±–∏—Ä–∞–µ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        statusMessage.textContent = '';
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–≤–µ—Ä–ª–µ–π
        successOverlay.style.display = 'flex';
        // –°–±—Ä–æ—Å–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é
        form.classList.remove('was-validated');
      })
      .catch(error => {
        statusMessage.textContent = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ: ' + error;
        statusMessage.className = 'mt-3 text-danger';
        console.error('–û—à–∏–±–∫–∞:', error);
      });
  });

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ ¬´–ó–∞–ø–æ–ª–Ω–∏—Ç—å –µ—â—ë¬ª
  fillAgainBtn.addEventListener('click', () => {
    // –°–∫—Ä—ã–≤–∞–µ–º –æ–≤–µ—Ä–ª–µ–π
    successOverlay.style.display = 'none';
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É, –∫—Ä–æ–º–µ –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ –∫—É–∫–∏
    form.reset();
    
    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫—É–∫–∏
    const savedDepartment = getCookie('department');
    if (savedDepartment) {
      document.getElementById('department').value = savedDepartment;
    }
    const savedContactName = getCookie('contactName');
    if (savedContactName) {
      document.getElementById('contactName').value = savedContactName;
    }
    const savedContactPhone = getCookie('contactPhone');
    if (savedContactPhone) {
      document.getElementById('contactPhone').value = savedContactPhone;
    }
  });
</script>

</body>
</html>